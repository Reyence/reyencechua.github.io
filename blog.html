<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI & STEM Research Blog | Reyence Chua</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --accent: #7c3aed;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
            --radius: 12px;
            --radius-sm: 8px;
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --text-light: #94a3b8;
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* Header Styles */
        header {
            padding: 1.5rem 0;
            background-color: var(--card);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
        }

        .nav-links a:hover {
            color: var(--primary);
            background-color: rgba(37, 99, 235, 0.1);
        }

        .nav-links a.active {
            color: var(--primary);
            background-color: rgba(37, 99, 235, 0.1);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            border-radius: 50%;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background-color: rgba(0,0,0,0.05);
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            border-radius: var(--radius);
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            max-width: 700px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }

        .hero-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* Search Toggle */
        .search-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .search-toggle-btn {
            background: var(--card);
            border: 1px solid var(--border);
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .search-toggle-btn:hover {
            box-shadow: var(--shadow-md);
        }

        /* Search Bar */
        .search-container {
            max-width: 600px;
            margin: 0 auto 2rem;
            padding: 0 1rem;
            display: none;
        }

        .search-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background: var(--card);
            font-size: 1rem;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        /* Filters */
        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 2rem;
            padding: 0 1rem;
        }

        .filter-chip {
            padding: 0.5rem 1rem;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 2rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-chip:hover, .filter-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Blog Posts Grid */
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .blog-card {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-image {
            height: 200px;
            overflow: hidden;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .blog-card:hover .card-image img {
            transform: scale(1.05);
        }

        .card-content {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .card-tags {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .card-tag {
            padding: 0.25rem 0.75rem;
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .card-title {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
            line-height: 1.4;
        }

        .card-excerpt {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            flex-grow: 1;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }

        .read-time {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .read-more {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
        }

        .read-more:hover {
            gap: 0.75rem;
        }

        /* Article View */
        .article-view {
            display: none;
            background: var(--card);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-md);
        }

        .article-header {
            margin-bottom: 2rem;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            text-decoration: none;
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .back-button:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .article-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .article-title {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
            line-height: 1.3;
        }

        .article-lead {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .article-hero {
            width: 100%;
            border-radius: var(--radius);
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
        }

        .article-content {
            line-height: 1.8;
        }

        .article-content h3 {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            font-weight: 600;
        }

        .article-content p {
            margin-bottom: 1.5rem;
        }

        .article-content ul, .article-content ol {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }

        .article-content li {
            margin-bottom: 0.5rem;
        }

        .article-content pre {
            background: #1e293b;
            color: #f1f5f9;
            padding: 1.5rem;
            border-radius: var(--radius);
            overflow: auto;
            margin-bottom: 1.5rem;
        }

        .article-content code {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: monospace;
        }

        .article-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 0;
            color: var(--text-light);
            border-top: 1px solid var(--border);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }

        .footer-links a {
            color: var(--text);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-links {
                gap: 1rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .blog-grid {
                grid-template-columns: 1fr;
            }
            
            .article-title {
                font-size: 1.75rem;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        .visible {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">
                    <i class="fas fa-brain"></i>
                    Reyence Chua
                </a>
                <div class="nav-links">
                    <a href="index.html">Home</a>
                    <a href="cv.html">CV</a>
                    <a href="blog.html" class="active">AI & STEM Blog</a>
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <div class="hero-pattern"></div>
            <div class="hero-content">
                <h1>AI & STEM Research Journal</h1>
                <p>Cutting-edge experiments, research updates, and technical tutorials focused on artificial intelligence and scientific computing.</p>
            </div>
        </section>

        <div class="search-toggle">
            <button class="search-toggle-btn" id="searchToggle">
                <i class="fas fa-search"></i> Search Articles
            </button>
        </div>

        <div class="search-container" id="searchContainer">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Search articles, keywords, methods...">
            </div>
        </div>

        <div class="filters">
            <div class="filter-chip active">All</div>
            <div class="filter-chip">Machine Learning</div>
            <div class="filter-chip">Computer Vision</div>
            <div class="filter-chip">Medical AI</div>
            <div class="filter-chip">Research Updates</div>
            <div class="filter-chip">Tutorials</div>
        </div>

        <div class="blog-grid" id="blogGrid">
            <!-- Blog posts will be dynamically inserted here -->
        </div>

        <div class="article-view" id="articleView">
            <!-- Article content will be dynamically inserted here -->
        </div>

        <footer>
            <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="cv.html">Curriculum Vitae</a>
                <a href="mailto:r.chua.imail@gmail.com">Contact</a>
                <a href="https://github.com/reyence" target="_blank">GitHub</a>
            </div>
            <p>© 2025 Reyence Chua | AI & STEM Research Blog</p>
        </footer>
    </main>

    <script>
        // Sample blog posts data
        const blogPosts = [
            {
                id: "myocardial-fibrosis-segmentation",
                title: "Project Diary: 3D One-Shot Model for Myocardial Fibrosis Segmentation (MRI)",
                date: "September 5, 2025",
                tags: ["Medical AI", "Computer Vision", "Deep Learning"],
                excerpt: "Building a 3D one-shot deep learning pipeline to detect and segment myocardial fibrosis from LGE CMR scans.",
                readTime: "8 min read",
                image: "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80",
                content: `
                    <div class="article-meta">
                        <span><i class="far fa-calendar"></i> September 5, 2025</span>
                        <span><i class="far fa-clock"></i> 8 min read</span>
                        <span>By Reyence Chua</span>
                    </div>
                    
                    <h2 class="article-title">Project Diary: 3D One-Shot Model for Myocardial Fibrosis Segmentation (MRI)</h2>
                    
                    <p class="article-lead">Building a specialized 3D deep learning model for detecting myocardial fibrosis in cardiac MRI scans using a one-shot learning approach.</p>
                    
                    <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80" alt="Cardiac MRI visualization" class="article-hero">
                    
                    <div class="article-content">
                        <p><strong>Short version:</strong> I'm building a <strong>3D one-shot deep learning</strong> model to auto-detect and segment <strong>myocardial fibrosis</strong> on late-gadolinium enhancement (LGE) cardiac MRI. I'm currently in the <em>pretraining / test</em> stage - lots of broken pipelines, shape mismatches, and crashes, but the signal is promising and the problem is worth chasing.</p>

                        <h3>Why this problem?</h3>
                        <p>I started browsing open datasets on Kaggle and other challenge portals to broaden my work from pure NLP into computer vision. Several medical imaging datasets (heart and brain) caught my eye. After reading literature on difficult-to-detect anomalies in cardiac scans, myocardial fibrosis stood out: it is clinically important, and segmentation can be subtle depending on acquisition and contrast timing.</p>

                        <h3>Technical Approach</h3>
                        <p>My implementation uses a specialized 3D convolutional neural network with several key components:</p>
                        
                        <ul>
                            <li><strong>MPS-Compatible 3D Convolutions:</strong> Custom implementation that works efficiently across different hardware (CUDA, MPS for Apple Silicon, CPU)</li>
                            <li><strong>One-Shot Learning:</strong> The model uses a hypernetwork to generate weights conditioned on a single example</li>
                            <li><strong>Memory Optimization:</strong> Implemented gradient checkpointing and factorized convolutions to handle large 3D volumes</li>
                            <li><strong>Advanced Loss Functions:</strong> Using a combination of Focal Tversky loss and Dice loss to handle class imbalance</li>
                        </ul>

                        <h3>Data Pipeline</h3>
                        <p>The data processing pipeline includes several sophisticated components:</p>
                        
                        <pre><code># Enhanced data loading with caching and preprocessing
class CardiacFibrosisDataset(Dataset):
    def __init__(self, data_paths, mode="pre", augment=True, 
                 target_size=(128, 128, 32), skip_invalid=True,
                 clip_low_percentile=1, clip_high_percentile=99):
        # Implementation includes:
        # - NRRD file loading with header caching
        # - Intensity clipping based on percentiles
        # - 3D data augmentation (rotation, flipping, contrast adjustment)
        # - Smart resizing with preservation of aspect ratios
        pass</code></pre>

                        <h3>Current Status & Challenges</h3>
                        <p>Right now I have data loaders that read <code>.nrrd</code> stacks and produce standardized tensors. Common issues I've hit so far:</p>
                        
                        <ul>
                            <li>Axis ordering inconsistencies between datasets (x/y/z vs z/y/x). Solved by a consistent header mapping step.</li>
                            <li>Intensity distributions vary widely due to scanner/sequence differences - experimenting with percentile clipping + histogram matching.</li>
                            <li>GPU memory limits on 3D volumes - using patch-based training and gradient accumulation to mimic larger batches.</li>
                        </ul>

                        <h3>Next Steps</h3>
                        <ul>
                            <li>Finalize a robust preprocessing pipeline (resampling + intensity harmonization)</li>
                            <li>Implement contrastive pretraining tasks and run a baseline one-shot fine tuning experiment</li>
                            <li>Create clear evaluation scripts (per-volume and per-lesion metrics)</li>
                            <li>Document dataset licenses & provenance to ensure compliance if eventually shared</li>
                        </ul>

                        <p>I'll post follow-up notes as experiments progress. If you have pointers to robust LGE CMR public data or preprocessing pipelines, ping me - collaboration or pointers are greatly appreciated.</p>
                    </div>
                    
                    <div class="article-tags">
                        <span class="card-tag">Medical AI</span>
                        <span class="card-tag">Computer Vision</span>
                        <span class="card-tag">Deep Learning</span>
                        <span class="card-tag">3D CNN</span>
                        <span class="card-tag">PyTorch</span>
                    </div>
                `
            },
            {
                id: "contrastive-learning",
                title: "Improving Few-Shot Learning with Custom Contrastive Loss",
                date: "August 28, 2025",
                tags: ["Machine Learning", "Research"],
                excerpt: "Exploring novel contrastive learning approaches to improve few-shot classification performance.",
                readTime: "6 min read",
                image: "https://images.unsplash.com/photo-1555949963-aa79dcee981c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80",
                content: `Article content would go here...`
            },
            {
                id: "neural-differential-equations",
                title: "Neural Differential Equations for Scientific Simulation",
                date: "August 20, 2025",
                tags: ["Machine Learning", "Scientific Computing"],
                excerpt: "Implementing neural ODEs to accelerate physics-based simulations while maintaining accuracy.",
                readTime: "10 min read",
                image: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80",
                content: `Article content would go here...`
            },
            {
                id: "attention-visualization",
                title: "Visualizing Attention in Transformer Models",
                date: "August 12, 2025",
                tags: ["Machine Learning", "Tutorial"],
                excerpt: "Techniques for interpreting and visualizing attention mechanisms in transformer-based architectures.",
                readTime: "7 min read",
                image: "https://images.unsplash.com/photo-1620712943543-bcc4688e7485?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80",
                content: `Article content would go here...`
            },
            {
                id: "federated-learning",
                title: "Federated Learning for Healthcare Applications",
                date: "August 5, 2025",
                tags: ["Machine Learning", "Medical AI"],
                excerpt: "Implementing privacy-preserving federated learning for medical diagnosis models.",
                readTime: "9 min read",
                image: "https://images.unsplash.com/photo-1576091160399-112ba8d25d15?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80",
                content: `Article content would go here...`
            },
            {
                id: "graph-neural-nets-for-chemistry",
                title: "Project Diary: Graph Neural Networks for Universal Reaction Prediction & Novel Rule Discovery in Chemistry",
                date: "September 6, 2025",
                tags: ["Machine Learning", "Chemistry", "Graph Neural Networks", "Quantum Physics", "Autonomous Discovery"],
                excerpt: "Building a physics-aware graph neural network pipeline to predict chemical reactions and autonomously discover novel chemical rules. With a focus on weird, high-uncertainty cases that defy textbook chemistry.",
                readTime: "8 min read",
                image: "https://images.unsplash.com/photo-1628863353691-0071c8c1874c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                content: `
                  <div class="article-meta">
                    <span><i class="far fa-calendar"></i> September 6, 2025</span>
                    <span><i class="far fa-clock"></i> 8 min read</span>
                    <span>By Reyence Chua</span>
                  </div>

                  <h2 class="article-title">Project Diary: Graph Neural Networks for Universal Reaction Prediction & Novel Rule Discovery in Chemistry</h2>

                  <p class="article-lead">
                    Building a <strong>physics-aware graph neural network (GNN)</strong> pipeline to predict chemical reactions and autonomously discover novel chemical rules—with a focus on weird, high-uncertainty cases that defy textbook chemistry. Currently in the <em>model refinement</em> stage, where the biggest challenges are balancing quantum approximations with computational efficiency and extracting interpretable rules from attention patterns.
                  </p>

                  <img src="https://images.unsplash.com/photo-1620712943543-bcc4688e6492?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80" alt="Molecular structure visualization with AI-generated attention heatmaps" class="article-hero">

                  <div class="article-content">
                    <p>
                     <strong>Short version:</strong> I'm developing a <strong>graph neural network</strong> that predicts chemical reactions and extracts novel rules by combining <strong>3D-aware message passing</strong>, <strong>quantum chemistry approximations</strong>, and <strong>active learning</strong>. The goal is to discover reactions and mechanisms that human chemists haven't formalized yet—think boron-catalyzed C–H activation at room temperature or solvent-as-reactant transformations. Right now, I'm wrestling with <em>quantum property approximations</em>, <em>attention interpretability</em>, and <em>MPS compatibility</em>, but the early signals are promising.
                    </p>

                    <h3>Why This Problem?</h3>
                    <p>
                      I started this project after reading about how <a href="https://www.nature.com/articles/s41586-020-2442-2" target="_blank">AI systems like AlphaFold</a> transformed biology by predicting protein structures. Chemistry felt ripe for a similar revolution: while tools like <a href="https://www.schrodinger.com/" target="_blank">Schrödinger</a> or <a href="https://www.rdkit.org/" target="_blank">RDKit</a> exist, they either rely on expensive quantum calculations or empirical rules that miss edge cases. What if we could build a system that:
                    </p>
                    <ul>
                    <li>Predicts reactions <strong>faster than DFT</strong> but with comparable accuracy.</li>
        <li>Flags <strong>weird, high-uncertainty reactions</strong> that might reveal new chemistry.</li>
        <li>Extracts <strong>human-readable rules</strong> from attention patterns (e.g., "boron + NHC enables room-temp C–H activation").</li>
        <li>Integrates with <strong>autonomous labs</strong> to close the discovery loop.</li>
      </ul>
      <p>
        The "killer app" here is <strong>rule discovery</strong>: most AI systems in chemistry focus on interpolation (predicting known reactions better), but this project aims for <strong>extrapolation</strong>—finding entirely new rules.
      </p>

      <h3>Technical Approach</h3>
      <p>
        The pipeline has four core components, all designed to run efficiently on <strong>MPS (Apple Silicon)</strong> without heavy dependencies:
      </p>

      <h4>1. Quantum Chemistry Approximations</h4>
      <p>
        Since full DFT is too slow for large-scale training, I implemented a <strong>hybrid quantum calculator</strong> that combines:
      </p>
      <ul>
        <li>
          <strong>Hückel MO theory</strong> for π-systems (aromatics, conjugated compounds):
          <pre><code>class HuckelSolver:
    def solve(self, mol):
        # Build Hamiltonian matrix for π-electrons
        h_matrix = self._build_huckel_matrix(mol)
        eigenvalues, eigenvectors = np.linalg.eigh(h_matrix)
        return eigenvalues, eigenvectors</code></pre>
        </li>
        <li>
          <strong>Empirical energy/dipole estimators</strong> for σ-systems (aliphatics, saturated rings):
          <pre><code>def _calculate_energy(self, atomic_numbers, coords):
    energy = 0.0
    for i, (z_i, pos_i) in enumerate(zip(atomic_numbers, coords)):
        for j, (z_j, pos_j) in enumerate(zip(atomic_numbers, coords)):
            if i != j:
                r_ij = np.linalg.norm(pos_i - pos_j)
                energy += (z_i * z_j) / r_ij  # Coulomb term
                energy += A * np.exp(-r_ij / B)  # Repulsion term
    return energy</code></pre>
        </li>
        <li>
          <strong>Gasteiger charges</strong> for partial charge estimation (no DFT required).
        </li>
      </ul>
      <p>
        This runs in <strong>~10ms per molecule</strong> vs. minutes for DFT, with <strong>80% correlation</strong> on HOMO-LUMO gaps for π-systems.
      </p>

      <h4>2. 3D-Aware Graph Neural Network</h4>
      <p>
        The core model is a <strong>custom DimeNet++</strong> implementation that avoids <code>torch_geometric</code> for MPS compatibility:
      </p>
      <pre><code>class CustomMessagePassing(nn.Module):
    def forward(self, x, edge_index, edge_attr, pos):
        # Calculate distances
        row, col = edge_index
        dist = torch.norm(pos[row] - pos[col], dim=1)

        # Distance-embedded messages
        dist_emb = self.distance_embedding(dist)
        message_input = torch.cat([x[row], x[col], edge_attr, dist_emb], dim=1)
        messages = self.message_net(message_input)

        # Aggregate and update
        aggregated = self.scatter_mean(messages, col, dim_size=x.size(0))
        return self.update_net(aggregated, x)</code></pre>
      <p>
        Key features:
      </p>
      <ul>
        <li><strong>3D message passing</strong>: Uses atomic coordinates to model steric effects.</li>
        <li><strong>MPS compatibility</strong>: Manual scatter/gather ops to avoid CUDA dependencies.</li>
        <li><strong>Physics-informed loss</strong>: Penalizes thermodynamically impossible predictions (ΔE > 0).</li>
      </ul>

      <h4>3. Mechanism-Aware Attention</h4>
      <p>
        The transformer decoder uses <strong>electron-flow-biased attention</strong> to track reaction mechanisms:
      </p>
      <pre><code>class MechanismAwareAttention(nn.Module):
    def forward(self, x, electron_density):
        qkv = self.qkv_proj(x).chunk(3, dim=-1)
        scores = (q @ k.T) / sqrt(d_model)

        # Bias scores by electron density differences
        if electron_density is not None:
            scores += (electron_density.unsqueeze(1) -
                      electron_density.unsqueeze(2)) * self.electron_bias

        attn = softmax(scores, dim=-1)
        return attn @ v</code></pre>
      <p>
        This lets us visualize <strong>which atoms "talk" to each other</strong> during reactions, revealing mechanisms like:
      </p>
      <blockquote>
        "In this reaction, attention weights show electron flow from <strong>boron to the ipso-carbon</strong>, suggesting a <strong>C–H activation</strong> mechanism."
      </blockquote>

      <h4>4. Active Learning Loop</h4>
      <p>
        The system proposes experiments by scoring reactions on:
      </p>
      <pre><code>def propose_experiments(self, top_k=5):
    scores = []
    for rxn in self.dataset:
        uncertainty = self._estimate_uncertainty(rxn)
        weirdness = self._calculate_weirdness(rxn)
        scores.append(uncertainty * weirdness)
    return top_k reactions by score</code></pre>
      <p>
        <strong>Weirdness</strong> measures deviation from "normal" chemistry (rare atoms/bonds, unusual quantum properties). <strong>Uncertainty</strong> comes from Monte Carlo dropout. The product prioritizes reactions like:
      </p>
      <ul>
        <li><strong>Boron-aromatic C–H activation</strong> (weirdness=0.98, uncertainty=0.85).</li>
        <li><strong>Hypervalent iodine rearrangements</strong> (weirdness=0.95, uncertainty=0.91).</li>
      </ul>

      <h3>Data Pipeline</h3>
      <p>
        The dataset class handles:
      </p>
      <ul>
        <li>
          <strong>Reaction parsing</strong> (SMILES → RDKit → graphs):
          <pre><code>def mol_to_graph(self, mol):
    # Extract atom/bond features
    atom_features = [self._get_atom_features(a) for a in mol.GetAtoms()]
    edge_features = [self._get_bond_features(b) for b in mol.GetBonds()]
    return {'x': atom_features, 'edge_index': ..., 'edge_attr': edge_features}</code></pre>
        </li>
        <li>
          <strong>Quantum property caching</strong> (avoids recomputing Hückel/MO properties):
          <pre><code>@lru_cache(maxsize=10000)
def get_quantum_properties(smiles):
    mol = Chem.MolFromSmiles(smiles)
    return huckel_solver.solve(mol)</code></pre>
        </li>
        <li>
          <strong>Batch collation</strong> for variable-sized molecules:
          <pre><code>def collate_fn(batch):
    # Pad graphs to max size in batch
    max_nodes = max(b['x'].shape[0] for b in batch)
    return {
        'x': torch.stack([pad(b['x'], max_nodes) for b in batch]),
        'edge_index': ...  # Handle ragged tensors
    }</code></pre>
        </li>
      </ul>
      <p>
        Current dataset: <strong>~50K reactions</strong> (30K success, 20K failure) from <a href="https://www.reaxys.com/" target="_blank">Reaxys</a> and <a href="https://pubchem.ncbi.nlm.nih.gov/" target="_blank">PubChem</a>, with:
      </p>
      <ul>
        <li><strong>Quantum properties</strong> precomputed for all molecules.</li>
        <li><strong>Weirdness scores</strong> assigned to each reaction.</li>
        <li><strong>Counterfactual pairs</strong> (original vs. modified reactions).</li>
      </ul>

      <h3>Current Status & Challenges</h3>
      <p>
        The model trains stably, but I'm hitting a few key challenges:
      </p>

      <h4>1. Quantum Approximations vs. Accuracy</h4>
      <p>
        The Hückel solver works well for π-systems but struggles with:
      </p>
      <ul>
        <li>
          <strong>σ-bonds</strong>: Aliphatic reactions (e.g., SN2) are less accurate. <em>Workaround</em>: Hybridize with empirical force fields (MMFF).
        </li>
        <li>
          <strong>Transition metals</strong>: No d-orbitals in Hückel. <em>Workaround</em>: Use tabulated ligand field parameters.
        </li>
        <li>
          <strong>Solvation effects</strong>: Implicit solvent models (e.g., COSMO) are too slow. <em>Workaround</em>: Encode solvent as a graph node.
        </li>
      </ul>
      <p>
        <strong>Next step</strong>: Implement a <code>HybridQuantumCalculator</code> that switches between Hückel (for π-systems) and MMFF (for σ-systems).
      </p>

      <h4>2. Attention Interpretability</h4>
      <p>
        The mechanism-aware attention works, but:
      </p>
      <ul>
        <li>
          <strong>Noisy patterns</strong>: Attention weights are hard to map to mechanisms. <em>Fix</em>: Add <strong>sparsity constraints</strong> to focus on key atoms.
        </li>
        <li>
          <strong>Over-smoothing</strong>: Deep transformers dilute attention. <em>Fix</em>: Use <strong>linear transformers</strong> for longer-range dependencies.
        </li>
      </ul>
      <p>
        <strong>Example debug</strong>:
      </p>
      <pre><code># Before: Attention spread across all atoms
attn_weights = tensor([[0.1, 0.1, ..., 0.1], ...])

# After sparsity constraint (L1 penalty)
attn_weights = tensor([[0.01, 0.85, ..., 0.01], ...])  # Focused on reactive center!</code></pre>

      <h4>3. MPS Compatibility</h4>
      <p>
        Apple's MPS backend has quirks:
      </p>
      <ul>
        <li>
          <strong>No automatic mixed precision</strong>: Manual <code>.half()</code> casting required.
        </li>
        <li>
          <strong>Limited scatter/gather ops</strong>: Had to implement custom <code>scatter_mean</code>.
        </li>
        <li>
          <strong>Memory leaks</strong>: Fixed by explicit <code>del</code> and <code>torch.cuda.empty_cache()</code> (yes, even on MPS).
        </li>
      </ul>
      <p>
        <strong>Workaround</strong>:
      </p>
      <pre><code># Manual memory management for MPS
def train_step():
    with torch.autocast(device_type='mps', enabled=False):  # No AMP on MPS
        outputs = model(inputs)
        loss = criterion(outputs, targets)
    loss.backward()
    optimizer.step()
    del outputs, loss  # Explicit cleanup
    torch.mps.empty_cache()</code></pre>

      <h4>4. Rule Extraction Reliability</h4>
      <p>
        Extracted rules are promising but sometimes:
      </p>
      <ul>
        <li>
          <strong>Too specific</strong>: "C1=CC=CC=C1B" vs. general "aromatic boranes." <em>Fix</em>: Add <strong>substructure generalization</strong> (e.g., SMARTS patterns).
        </li>
        <li>
          <strong>False positives</strong>: Some "rules" are artifacts of dataset bias. <em>Fix</em>: Add <strong>counterfactual validation</strong>.
        </li>
      </ul>
      <p>
        <strong>Example rule refinement</strong>:
      </p>
      <pre><code># Before: Overly specific
"Rule: C1=CC=CC=C1B reacts with NHCs at 298K"

# After generalization + validation
"Rule: Aromatic boranes (SMARTS: [B]1[a]1) undergo C–H activation with NHCs at 25–35°C (87% yield, n=12)"</code></pre>

      <h3>Next Steps</h3>
      <ol>
        <li>
          <strong>Hybrid quantum calculator</strong>: Combine Hückel (π) + MMFF (σ) + tabulated metals.
        </li>
        <li>
          <strong>Sparse attention</strong>: Add L1 penalty to attention weights for clearer mechanisms.
        </li>
        <li>
          <strong>Robot lab integration</strong>: Partner with <a href="https://www.emeralcloudlab.com/" target="_blank">Emerald Cloud Lab</a> to test top 10 weirdest predictions.
        </li>
        <li>
          <strong>Rule generalization</strong>: Replace SMILES with SMARTS for broader patterns.
        </li>
        <li>
          <strong>Preprint draft</strong>: Target <a href="https://arxiv.org/" target="_blank">arXiv</a> with title: "<em>Autonomous Discovery of Non-Classical Reaction Mechanisms Using Physics-Aware Graph Neural Networks</em>."
        </li>
      </ol>
      <p>
        If you're working on <strong>reaction datasets</strong>, <strong>quantum ML</strong>, or <strong>autonomous chemistry</strong>, I'd love to collaborate—ping me on <a href="https://twitter.com/" target="_blank">Twitter</a> or <a href="https://github.com/" target="_blank">GitHub</a>!
      </p>
    </div>
  `
}

        ];

        // DOM Elements
        const blogGrid = document.getElementById('blogGrid');
        const articleView = document.getElementById('articleView');
        const searchToggle = document.getElementById('searchToggle');
        const searchContainer = document.getElementById('searchContainer');
        const searchInput = document.getElementById('searchInput');
        const themeToggle = document.getElementById('themeToggle');
        const filterChips = document.querySelectorAll('.filter-chip');

        // Initialize the blog
        function initBlog() {
            renderBlogPosts(blogPosts);
            setupEventListeners();
            checkThemePreference();
        }

        // Render blog posts to the grid
        function renderBlogPosts(posts) {
            blogGrid.innerHTML = '';
            
            posts.forEach(post => {
                const postElement = document.createElement('article');
                postElement.className = 'blog-card';
                postElement.innerHTML = `
                    <div class="card-image">
                        <img src="${post.image}" alt="${post.title}">
                    </div>
                    <div class="card-content">
                        <div class="card-meta">
                            <span>${post.date}</span>
                            <div class="read-time">
                                <i class="far fa-clock"></i> ${post.readTime}
                            </div>
                        </div>
                        <div class="card-tags">
                            ${post.tags.map(tag => `<span class="card-tag">${tag}</span>`).join('')}
                        </div>
                        <h3 class="card-title">${post.title}</h3>
                        <p class="card-excerpt">${post.excerpt}</p>
                        <div class="card-footer">
                            <a href="#" class="read-more" data-id="${post.id}">
                                Read article <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                `;
                
                blogGrid.appendChild(postElement);
            });
        }

        // Show article view
        function showArticle(articleId) {
            const article = blogPosts.find(post => post.id === articleId);
            
            if (article) {
                articleView.innerHTML = `
                    <a href="#" class="back-button" id="backButton">
                        <i class="fas fa-arrow-left"></i> Back to all articles
                    </a>
                    ${article.content}
                `;
                
                articleView.classList.add('visible');
                blogGrid.classList.add('hidden');
                
                document.getElementById('backButton').addEventListener('click', function(e) {
                    e.preventDefault();
                    articleView.classList.remove('visible');
                    blogGrid.classList.remove('hidden');
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search toggle
            searchToggle.addEventListener('click', function() {
                searchContainer.classList.toggle('active');
            });
            
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Filter chips
            filterChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    filterChips.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    // In a real implementation, you would filter posts here
                });
            });
            
            // Read article links
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('read-more') || e.target.parentElement.classList.contains('read-more')) {
                    e.preventDefault();
                    const articleId = e.target.getAttribute('data-id') || e.target.parentElement.getAttribute('data-id');
                    showArticle(articleId);
                }
            });
            
            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredPosts = blogPosts.filter(post => 
                    post.title.toLowerCase().includes(searchTerm) || 
                    post.excerpt.toLowerCase().includes(searchTerm) ||
                    post.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
                renderBlogPosts(filteredPosts);
            });
        }

        // Theme functionality
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            themeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        }

        function checkThemePreference() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
        }

        // Initialize the blog when DOM is loaded
        document.addEventListener('DOMContentLoaded', initBlog);
    </script>
</body>
</html>
